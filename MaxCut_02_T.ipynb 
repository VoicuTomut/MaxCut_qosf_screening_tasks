{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "patient-twist",
   "metadata": {},
   "outputs": [],
   "source": [
    "import networkx as nx\n",
    "import numpy as np\n",
    "\n",
    "from matplotlib import pyplot as plt"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "endangered-clause",
   "metadata": {},
   "outputs": [],
   "source": [
    "import pennylane as qml\n",
    "\n",
    "from pennylane import numpy as np"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "complicated-kenya",
   "metadata": {},
   "outputs": [],
   "source": [
    "np.random.seed(50)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 42,
   "id": "intense-haven",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "nr_nodes=4\n",
    "n_wires = nr_nodes\n",
    "graph =[(0, 1, 1), (0, 3, 1), (1, 2, 1), (2, 3, 1)]\n",
    "G=nx.Graph()\n",
    "G.add_weighted_edges_from(graph)\n",
    "nx.draw(G,with_labels=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 43,
   "id": "stuffed-prototype",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Best cut (cost=4.0): \n",
      " \n",
      "[1, 0, 1, 0]\n",
      "[0, 1, 0, 1]\n"
     ]
    }
   ],
   "source": [
    "#brut force  for verification  :\n",
    "def brut_MaxCut(graph,nr_nodes):\n",
    "    \n",
    "    W=np.zeros((int(nr_nodes),int(nr_nodes)))\n",
    "    for i in graph:\n",
    "        W[i[0]][i[1]]=i[2]\n",
    "        W[i[1]][i[0]]=i[2]       \n",
    "\n",
    "\n",
    "    best_cost_brute=0\n",
    "    max_str=[]\n",
    "    maxim=0\n",
    "    for b in range(2**nr_nodes):\n",
    "        x=[int(t) for t in reversed(list(bin(b)[2:].zfill(nr_nodes)))]\n",
    "        cost=0\n",
    "        for i in range(nr_nodes):\n",
    "            for j in range(nr_nodes):\n",
    "                cost=cost+W[i,j]*x[i]*(1-x[j])\n",
    "\n",
    "        \n",
    "        if best_cost_brute==cost:\n",
    "            max_str.append(str(x))\n",
    "            \n",
    "        if best_cost_brute<cost:\n",
    "            best_cost_brute=cost\n",
    "            max_str=[]\n",
    "            max_str.append(str(x))\n",
    " \n",
    "            \n",
    "    return  max_str, best_cost_brute\n",
    "            \n",
    "#Example:#      \n",
    "max_str, best_cost= brut_MaxCut(graph,nr_nodes)  \n",
    "print(\"Best cut (cost={}): \\n \".format(best_cost))\n",
    "for i in max_str:\n",
    "    print(i)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 44,
   "id": "flying-layer",
   "metadata": {},
   "outputs": [],
   "source": [
    "def UB_01(beta,n_wires):\n",
    "    for wire in range(n_wires):\n",
    "        qml.RX(2 * beta, wires=wire)\n",
    "        \n",
    "def UC_01(gamma,graph):\n",
    "    for edge in graph:\n",
    "        \n",
    "        wire1=edge[0]\n",
    "        wire2=edge[1]\n",
    "        w=edge[2]\n",
    "        \n",
    "        qml.CNOT(wires=[wire1, wire2])\n",
    "        qml.RZ(2*w*gamma, wires=wire2)\n",
    "        qml.CNOT(wires=[wire1, wire2])\n",
    "        \n",
    "        \n",
    "def Init_H(n_wires):\n",
    "    for wire in range(n_wires):\n",
    "        qml.Hadamard(wires=wire)\n",
    "        "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 45,
   "id": "amino-incidence",
   "metadata": {},
   "outputs": [],
   "source": [
    "def comp_basis_measurement(wires):\n",
    "    n_wires = len(wires)\n",
    "    return qml.Hermitian(np.diag(range(2 ** n_wires)), wires=wires)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 46,
   "id": "cross-application",
   "metadata": {},
   "outputs": [],
   "source": [
    "pauli_z = [[1, 0], [0, -1]]\n",
    "pauli_z_2 = np.kron(pauli_z, pauli_z)\n",
    "\n",
    "dev = qml.device(\"default.qubit\", wires=n_wires, analytic=True, shots=1)\n",
    "\n",
    "@qml.qnode(dev)\n",
    "def circuit(gammas, betas,n_wires,graph, edge=None, l=1):\n",
    "\n",
    "    Init_H(n_wires)\n",
    "    \n",
    "    for i in range(l):\n",
    "        UC_01(gammas[i],graph)\n",
    "        UB_01(betas[i],n_wires)\n",
    "        \n",
    "    if edge is None:\n",
    "        return qml.sample(comp_basis_measurement(range(n_wires)))\n",
    "    \n",
    "    return qml.expval(qml.Hermitian(pauli_z_2, wires=(edge[0],edge[1])))  # 1 circuit for eatc edge ?? sems not very practical"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 47,
   "id": "atmospheric-headline",
   "metadata": {},
   "outputs": [],
   "source": [
    "# minimize the negative of the objective function\n",
    "def objective(params,l,n_wires,graph,):\n",
    "    gammas = params[0]\n",
    "    betas = params[1]\n",
    "    cost = 0\n",
    "    for edge in graph:\n",
    "        # objective for the MaxCut problem\n",
    "        cost -= 0.5 * (1 - circuit(gammas, betas,n_wires=n_wires,graph=graph, edge=edge, l=l))\n",
    "    return cost"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 48,
   "id": "religious-dairy",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      " number of layers =1\n",
      "-Cost after step     5:  1.8999318\n",
      "-Cost after step    10:  2.9969795\n",
      "-Cost after step    15:  2.9998171\n",
      "-Cost after step    20:  2.9999867\n",
      "-Cost after step    25:  2.9999990\n",
      "-Cost after step    30:  2.9999999\n",
      "Optimized (gamma, beta) vectors:\n",
      "[[-1.17819515]\n",
      " [-0.39270054]]\n",
      "Most frequently sampled bit string is: 0101\n",
      "\n",
      " number of layers =2\n",
      "-Cost after step     5:  2.3018789\n",
      "-Cost after step    10:  3.6758721\n",
      "-Cost after step    15:  3.7325189\n",
      "-Cost after step    20:  3.8825902\n",
      "-Cost after step    25:  3.9366209\n",
      "-Cost after step    30:  3.9686664\n",
      "Optimized (gamma, beta) vectors:\n",
      "[[ 0.42780502  0.53856795]\n",
      " [-0.58294024 -0.47060787]]\n",
      "Most frequently sampled bit string is: 1010\n"
     ]
    }
   ],
   "source": [
    "def qaoa_maxcut(graph,n_wires,l=1,steps=30,n_samples = 100):\n",
    "    print(\"\\n number of layers ={:d}\".format(l))\n",
    "\n",
    "    # initialize the parameters near zero\n",
    "    init_params = 0.01 * np.random.rand(2, 2)\n",
    "\n",
    "    # initialize optimizer: Adagrad works well empirically\n",
    "    opt = qml.AdagradOptimizer(stepsize=0.5)\n",
    "    \n",
    "    # optimize parameters in objective\n",
    "    params = init_params\n",
    "    for i in range(steps):\n",
    "        params = opt.step(objective, params,n_wires=n_wires,graph=graph,l=l)\n",
    "        if (i + 1) % 5 == 0:\n",
    "            print(\"-Cost after step {:5d}: {: .7f}\".format(i + 1, -objective(params,n_wires=n_wires,graph=graph,l=l)))\n",
    "\n",
    "    bit_strings = []\n",
    "    for i in range(0, n_samples):\n",
    "        bit_strings.append(int(circuit(params[0], params[1], n_wires=n_wires,graph=graph, edge=None, l=l)))\n",
    "\n",
    "    # print optimal parameters and most frequently sampled bitstring\n",
    "    counts = np.bincount(np.array(bit_strings))\n",
    "    most_freq_bit_string = np.argmax(counts)\n",
    "    print(\"Optimized (gamma, beta) vectors:\\n{}\".format(params[:, :l]))\n",
    "    print(\"Most frequently sampled bit string is: {:04b}\".format(most_freq_bit_string))\n",
    "\n",
    "    return -objective(params,n_wires=n_wires,graph=graph,l=l), bit_strings\n",
    "\n",
    "\n",
    "# perform qaoa on our graph with p=1,2 and\n",
    "# keep the bitstring sample lists\n",
    "bitstrings1 = qaoa_maxcut(graph,nr_nodes,l=1,steps=30,n_samples = 100)[1]\n",
    "bitstrings2 = qaoa_maxcut(graph,nr_nodes,l=2,steps=30,n_samples = 100)[1]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 49,
   "id": "reasonable-intersection",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 576x288 with 2 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "xticks = range(0, 2**nr_nodes)\n",
    "xtick_labels = list(map(lambda x: format(x, \"04b\"), xticks))\n",
    "bins = np.arange(0, 17) - 0.5\n",
    "\n",
    "fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(8, 4))\n",
    "plt.subplot(1, 2, 1)\n",
    "plt.title(\"nr. layers=1\")\n",
    "plt.xlabel(\"bitstrings\")\n",
    "plt.ylabel(\"freq.\")\n",
    "plt.xticks(xticks, xtick_labels, rotation=\"vertical\")\n",
    "plt.hist(bitstrings1, bins=bins)\n",
    "plt.subplot(1, 2, 2)\n",
    "plt.title(\"nr. layers=2\")\n",
    "plt.xlabel(\"bitstrings\")\n",
    "plt.ylabel(\"freq.\")\n",
    "plt.xticks(xticks, xtick_labels, rotation=\"vertical\")\n",
    "plt.hist(bitstrings2, bins=bins)\n",
    "plt.tight_layout()\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "removable-print",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.9"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
